jQuery(function(l){var c=window.eadEmbed=window.eadEmbed||{};c.updateprovider=function(e,d){r(e,d)},c.human_filesize=function(e){!function(e){if(e<1024)return;var d=-1;for(;e/=1024,++d,1024<=e;);e.toFixed(1)}(e)},c.setpseudo=function(e){e=e,l("#new-provider").hide(),l("#ead-pseudo").show(),l("#ead-downloadc").hide(),l('select[name="ead-pseudo"]').val(e)},c.ead_showmsg=function(e){m(e)};var e=wp.template("embed-popup-template");l("#embed-popup-wrap-template").html(e);var d,o=l("#embed-popup-wrap-template").html(),t="",a={},n="",i=emebeder.msextension,u="undefined"!=typeof eadPublic&&eadPublic.adobe_api_key;function r(e,d){t=e.url,v(a=e,d),f(),function(e,d){l("#insert-doc").prop("disabled",!1),l("#ead-filename").html(e.filename),e.filesizeHumanReadable?l("#ead-filesize").html(e.filesizeHumanReadable):l("#ead-filesize").html("&nbsp;");l(".upload-success").fadeIn(),l(".ead-container").hide(),h(d)}(e,d)}function s(e){return-1==e.indexOf("%")?(e=e.replace(/[^0-9]/g,""),e+="px"):(e=e.replace(/[^0-9]/g,""),e+="%"),e}function p(){var e=l("#TB_window"),d=l(window).width(),o=l(window).height(),d=1080<d?1080:d;e.size()&&(e.width(d-50).height(o-45),l("#TB_ajaxContent").css({width:"100%",height:"100%",padding:"0"}),e.css({"margin-left":"-"+parseInt((d-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:"20px","margin-top":"0"}),l("#TB_title").css({"background-color":"#fff",color:"#cfcfcf"}))}function F(e,d){var o=l("#ead-"+e).val();return o&&("ead-"+e==d||o!=emebeder[e])}function m(e){l("#embed-message").fadeIn(),l("#embed-message p").text(e)}function f(e){e=void 0!==e&&e,a?l("#embed-popup #shortcode").text(function(e,d){var o=s(l("#ead-height").val()),t=s(l("#ead-width").val()),a=l("#ead-download").val(),n=l("#ead-provider").val(),i=l("#ead-text").val(),u=l("#ead-cache").is(":checked");c.shortcodeAttrs={},e.url&&(c.shortcodeAttrs.url=e.url),F("height",d)&&(c.shortcodeAttrs.height=o),F("width",d)&&(c.shortcodeAttrs.width=t),F("download",d)&&(c.shortcodeAttrs.download=a),F("provider",d)&&(c.shortcodeAttrs.viewer=n),F("text",d)&&"none"!=a&&(c.shortcodeAttrs.text=i),c.file=e,"google"==n?(l("#eadcachemain").show(),u&&(c.shortcodeAttrs.cache="off")):(l("#eadcachemain").hide(),l(".ead-browser-viewer-note").hide()),l("#embed-popup").trigger("awsm_ead_generate_embed_shortcode",[c.shortcodeAttrs,c.file]);var r="";return l.each(c.shortcodeAttrs,function(e,d){r+=e+'="'+d+'" '}),"[embeddoc "+r.trim()+"]"}(a,e)):l("#embed-popup #shortcode").text("")}function h(e){l(".uploaded-doccument").removeClass("ead-link ead-upload ead-dropbox ead-drive ead-box"),l(".uploaded-doccument").addClass("ead-"+e)}function b(){tb_remove(),setTimeout(function(){l("body").removeClass("ead-popup-on")},800)}function v(e,d){var o=i.split(","),t=e.filename,a=!1;"link"==d&&(a=!0,t=e.url);e="."+t.split(".").pop();l.each(["adobe","built-in","browser","microsoft"],function(e,d){l("#new-provider option[value='"+d+"']").attr({disabled:!1,hidden:!1})}),l(".ead-browser-viewer-note").hide(),-1!==l.inArray(d,["link","upload"])&&(-1===l.inArray(e,o)?(n="google",".pdf"==e&&u?n="adobe":l("#new-provider option[value='adobe']").attr({disabled:!0}),l("#new-provider option[value='"+n+"']").attr("selected","selected"),l("#new-provider option[value='microsoft']").attr({disabled:!0,hidden:!0}),l("#ead-provider").val(l("#new-provider option[value='"+n+"']").val())):(n="microsoft",l("#new-provider option[value='microsoft']").attr("selected","selected"),l("#ead-provider").val(l("#new-provider option[value='microsoft']").val())),".pdf"!=e&&(l("#new-provider option[value='browser']").attr({disabled:!0,hidden:!0}),l("#new-provider option[value='adobe']").attr({disabled:!0,hidden:!0})),(".pdf"!=e||"link"===d&&-1===t.indexOf(emebeder.site_url))&&l("#new-provider option[value='built-in']").attr({disabled:!0,hidden:!0}),a&&l("#new-provider").trigger("awsm_ead_check_item",[t]))}function w(){"none"==l("#ead-download").val()?l("#ead-download-text").hide():l("#ead-download-text").show()}l(document).on("click",".awsm-embed",function(e){0===l("#embed-popup").length&&l("body").append(o),e.preventDefault(),l(".ead-container").show(),l("#awsm-url").val(""),l(".ead-options").fadeIn(),l(".addurl-box").hide(),l(".upload-success").hide(),l("#embed-message").hide(),l("#insert-doc").prop("disabled",!0),l("#new-provider").show(),l("#ead-pseudo").hide(),l('select[name="ead-pseudo"]').val(""),n="",l("#new-provider  option[value='microsoft']").attr("disabled",!1),l("#ead-downloadc").show(),w(),l("body").addClass("ead-popup-on"),tb_show("Embed Any Document","#TB_inline?inlineId=embed-popup-wrap&amp;width=1030&amp;modal=true",null),p(),l("#upload-doc").focus()}),l(document).on("change",".ead-usc",function(){n="",f(l(this).attr("id")),w()}),l(".embedval").keyup(function(){f(l(this).attr("id"))}),l(document).on("click","#upload-doc",function(){d||(d=wp.media({title:"Embed Any Document",multiple:!1,library:{type:emebeder.validtypes},button:{text:emebeder.select_button}})).on("select",function(){r(d.state().get("selection").first().toJSON(),"upload")}),d.open()}),l(document).on("click","#ead-add-url",function(){var e=l("#awsm-url").val();""!==e?function(e){l("#embed-message").hide(),/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)?(e=(e=(t=e).split("/").pop())||emebeder.from_url,a={url:t,filename:e},l("#insert-doc").prop("disabled",!1),l("#ead-filename").html(emebeder.from_url),l("#ead-filesize").html("&nbsp;"),l(".upload-success").fadeIn(),l(".ead-container").hide(),h("link"),v(a,"link"),f()):m(emebeder.invalidurl)}(e):(l("#awsm-url").addClass("urlerror"),f())}),l(document).on("click","#insert-doc",function(){{var e;a?(e=!0,(e=void 0!==wp.blocks&&void 0!==wp.blocks.getBlockType("embed-any-document/document")?!1:e)&&wp.media.editor.insert(l("#embed-popup #shortcode").text()),b()):m(emebeder.nocontent)}}),l(document).on("click","#add-ead-document",function(e){e.preventDefault(),l(".addurl-box").fadeIn(),l(".ead-options").hide()}),l(document).on("click",".go-back",function(e){e.preventDefault(),l(".addurl-box").hide(),l(".ead-options").fadeIn()}),l(document).on("click","#embed-popup .cancel-embed,.ead-close",function(e){e.preventDefault(),b()}),l(window).resize(function(){p()})});