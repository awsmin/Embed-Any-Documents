jQuery(document).ready(function(s){var c=window.eadEmbed=window.eadEmbed||{};c.updateprovider=function(e,d){u(e,d)},c.human_filesize=function(e){!function(e){if(e<1024)return;var d=-1;for(;e/=1024,++d,1024<=e;);e.toFixed(1)}(e)},c.newprovider="";var e,d=s("#awsm-url"),o=s("#shortcode"),t=s("#embed-message p"),a=(s(".mceActionPanel"),s(".ead-container")),i="",n=emebeder.msextension,l=(emebeder.drextension,s("#embed-popup"));function u(e,d){i=e.url,v(e,d),f(),function(e,d){s("#insert-doc").removeAttr("disabled"),s("#ead-filename").html(e.filename),e.filesizeHumanReadable?s("#ead-filesize").html(e.filesizeHumanReadable):s("#ead-filesize").html("&nbsp;");s(".upload-success").fadeIn(),a.hide(),m(d)}(e,d)}function F(e){return-1==e.indexOf("%")?(e=e.replace(/[^0-9]/g,""),e+="px"):(e=e.replace(/[^0-9]/g,""),e+="%"),e}function r(){var e=s("#TB_window"),d=s(window).width(),o=s(window).height(),t=1080<d?1080:d;e.size()&&(e.width(t-50).height(o-45),s("#TB_ajaxContent").css({width:"100%",height:"100%",padding:"0"}),e.css({"margin-left":"-"+parseInt((t-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:"20px","margin-top":"0"}),s("#TB_title").css({"background-color":"#fff",color:"#cfcfcf"}))}function p(e,d){var o=s("#ead-"+e).val();return o&&("ead-"+e==d||o!=emebeder[e])}function f(e){e=void 0!==e&&e,i?o.text(function(e,d){var o=F(s("#ead-height").val()),t=F(s("#ead-width").val()),a=s("#ead-download").val(),i=s("#ead-provider").val(),n=s("#ead-text").val(),u=s("#ead-cache").is(":checked");c.shortcodeAttrs={url:e},p("height",d)&&(c.shortcodeAttrs.height=o),p("width",d)&&(c.shortcodeAttrs.width=t),p("download",d)&&(c.shortcodeAttrs.download=a),p("provider",d)&&(c.shortcodeAttrs.viewer=i),s("#embed-popup [data-setting]").each(function(){"viewer"==s(this).data("setting")&&(c.shortcodeAttrs.viewer=i,""!=c.newprovider&&(c.shortcodeAttrs.viewer=c.newprovider))}),c.newprovider="",p("text",d)&&"none"!=a&&(c.shortcodeAttrs.text=n),"google"==i?(s("#eadcachemain").show(),u&&(c.shortcodeAttrs.cache=off)):s("#eadcachemain").hide(),"browser"===i?s(".ead-browser-viewer-note").show():s(".ead-browser-viewer-note").hide(),l.trigger("ead_embed_shortcodetext",[c.shortcode]);var r="";return s.each(c.shortcodeAttrs,function(e,d){r+=e+'="'+d+'" '}),"[embeddoc "+r+"]"}(i,e)):o.text("")}function m(e){s(".uploaded-doccument").removeClass("ead-link ead-upload ead-dropbox ead-drive ead-box"),s(".uploaded-doccument").addClass("ead-"+e)}function h(){tb_remove(),setTimeout(function(){s("body").removeClass("ead-popup-on")},800)}function v(e,d){var o=n.split(","),t=e.filename;"link"==d&&(t=e.url);var a="."+t.split(".").pop();s.each(["built-in","browser","microsoft"],function(e,d){s("#new-provider option[value='"+d+"']").attr({disabled:!1,hidden:!1})}),s(".ead-browser-viewer-note").hide(),-1!==s.inArray(d,["link","upload"])&&(-1===s.inArray(a,o)?(s("#new-provider option[value='google']").attr("selected","selected"),s("#new-provider option[value='microsoft']").attr({disabled:!0,hidden:!0})):s("#new-provider option[value='microsoft']").attr("selected","selected"),".pdf"!=a&&s("#new-provider option[value='browser']").attr({disabled:!0,hidden:!0}),(".pdf"!=a||"link"===d&&-1===t.indexOf(emebeder.site_url))&&s("#new-provider option[value='built-in']").attr({disabled:!0,hidden:!0}))}function b(){"none"==s("#ead-download").val()?s("#ead-download-text").hide():s("#ead-download-text").show()}s("body").on("click",".awsm-embed",function(e){a.show(),d.val(""),s(".ead-options").fadeIn(),s(".addurl-box").hide(),s(".upload-success").hide(),s("#embed-message").hide(),s("#insert-doc").attr("disabled","disabled"),s("#new-provider").show(),s("#ead-pseudo").hide(),s("#new-provider  option[value='microsoft']").attr("disabled",!1),s("#ead-downloadc").show(),b(),e.preventDefault(),s("body").addClass("ead-popup-on"),tb_show("Embed Any Document","#TB_inline?inlineId=embed-popup-wrap&amp;width=1030&amp;modal=true",null),r(),s("#upload-doc").focus()}),s(".ead-usc").change(function(){f(s(this).attr("id")),b()}),s(".embedval").keyup(function(){f(s(this).attr("id"))}),s("#upload-doc").click(function(){if(e)return void e.open();(e=wp.media({title:"Embed Any Document",multiple:!1,library:{type:emebeder.validtypes},button:{text:emebeder.select_button}})).on("select",function(){u(e.state().get("selection").first().toJSON(),"upload")}),e.open()}),s("#ead-add-url").click(function(){var e=d.val();""!==e?function(e){{var d,o;s("#embed-message").hide(),function(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}(e)?(d=(d=(i=e).split("/").pop())||emebeder.from_url,o={url:i,filename:d},s("#insert-doc").removeAttr("disabled"),s("#ead-filename").html(emebeder.from_url),s("#ead-filesize").html("&nbsp;"),s(".upload-success").fadeIn(),a.hide(),m("link"),v(o,"link"),f()):function(e){s("#embed-message").fadeIn(),t.text(e)}(emebeder.invalidurl)}}(e):(d.addClass("urlerror"),f())}),s("#insert-doc").click(function(){{var e;i?(e=!0,void 0!==wp.blocks&&void 0!==wp.blocks.getBlockType("embed-any-document/document")&&(e=!1),e&&wp.media.editor.insert(o.text()),h()):showmsg(emebeder.nocontent)}}),s("#add-ead-document").on("click",function(e){e.preventDefault(),s(".addurl-box").fadeIn(),s(".ead-options").hide()}),s(".go-back").on("click",function(e){e.preventDefault(),s(".addurl-box").hide(),s(".ead-options").fadeIn()}),s("#embed-popup").on("click",".cancel-embed,.ead-close",function(e){e.preventDefault(),h()}),s(window).resize(function(){r()})});