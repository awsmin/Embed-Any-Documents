jQuery(document).ready(function(l){var s=window.eadEmbed=window.eadEmbed||{};s.updateprovider=function(e,d){F(e,d)},s.human_filesize=function(e){!function(e){if(e<1024)return;var d=-1;for(;e/=1024,++d,1024<=e;);e.toFixed(1)}(e)},s.setpseudo=function(e){var d;d=e,l("#new-provider").hide(),l("#ead-pseudo").show(),l("#ead-downloadc").hide(),l('select[name="ead-pseudo"]').val(d)},s.ead_showmsg=function(e){h(e)};var e=wp.template("embed-popup-template");l("#embed-popup-wrap-template").html(e);var d,o=l("#awsm-url"),t=l("#shortcode"),a=l("#embed-message p"),n=(l(".mceActionPanel"),l(".ead-container")),i="",u={},r=emebeder.msextension,c=(emebeder.drextension,l("#embed-popup"));function F(e,d){i=e.url,D(u=e,d),v(),function(e,d){l("#insert-doc").removeAttr("disabled"),l("#ead-filename").html(e.filename),e.filesizeHumanReadable?l("#ead-filesize").html(e.filesizeHumanReadable):l("#ead-filesize").html("&nbsp;");l(".upload-success").fadeIn(),n.hide(),b(d)}(e,d)}function p(e){return-1==e.indexOf("%")?(e=e.replace(/[^0-9]/g,""),e+="px"):(e=e.replace(/[^0-9]/g,""),e+="%"),e}function m(){var e=l("#TB_window"),d=l(window).width(),o=l(window).height(),t=1080<d?1080:d;e.size()&&(e.width(t-50).height(o-45),l("#TB_ajaxContent").css({width:"100%",height:"100%",padding:"0"}),e.css({"margin-left":"-"+parseInt((t-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:"20px","margin-top":"0"}),l("#TB_title").css({"background-color":"#fff",color:"#cfcfcf"}))}function f(e,d){var o=l("#ead-"+e).val();return o&&("ead-"+e==d||(o!=emebeder[e]||void console.log(e)))}function h(e){l("#embed-message").fadeIn(),a.text(e)}function v(e){e=void 0!==e&&e,u?t.text(function(e,d){var o=p(l("#ead-height").val()),t=p(l("#ead-width").val()),a=l("#ead-download").val(),n=l("#ead-provider").val(),i=l("#ead-text").val(),u=l("#ead-cache").is(":checked");s.shortcodeAttrs={},e.url&&(s.shortcodeAttrs.url=e.url),f("height",d)&&(s.shortcodeAttrs.height=o),f("width",d)&&(s.shortcodeAttrs.width=t),f("download",d)&&(s.shortcodeAttrs.download=a),f("provider",d)&&(s.shortcodeAttrs.viewer=n),f("text",d)&&"none"!=a&&(s.shortcodeAttrs.text=i),s.file=e,"google"==n?(l("#eadcachemain").show(),u&&(s.shortcodeAttrs.cache="off")):(l("#eadcachemain").hide(),l(".ead-browser-viewer-note").hide()),c.trigger("ead_embed_shortcodetext",[s.shortcodeAttrs,s.file]);var r="";return l.each(s.shortcodeAttrs,function(e,d){r+=e+'="'+d+'" '}),"[embeddoc "+r+"]"}(u,e)):t.text("")}function b(e){l(".uploaded-doccument").removeClass("ead-link ead-upload ead-dropbox ead-drive ead-box"),l(".uploaded-doccument").addClass("ead-"+e)}function w(){tb_remove(),setTimeout(function(){l("body").removeClass("ead-popup-on")},800)}function D(e,d){var o=r.split(","),t=e.filename;"link"==d&&(t=e.url);var a="."+t.split(".").pop();l.each(["built-in","browser","microsoft"],function(e,d){l("#new-provider option[value='"+d+"']").attr({disabled:!1,hidden:!1})}),l(".ead-browser-viewer-note").hide(),-1!==l.inArray(d,["link","upload"])&&(-1===l.inArray(a,o)?(l("#new-provider option[value='google']").attr("selected","selected"),l("#new-provider option[value='microsoft']").attr({disabled:!0,hidden:!0}),l("#ead-provider").val(l("#new-provider option[value='google']").val())):(l("#new-provider option[value='microsoft']").attr("selected","selected"),l("#ead-provider").val(l("#new-provider option[value='microsoft']").val())),".pdf"!=a&&l("#new-provider option[value='browser']").attr({disabled:!0,hidden:!0}),(".pdf"!=a||"link"===d&&-1===t.indexOf(emebeder.site_url))&&l("#new-provider option[value='built-in']").attr({disabled:!0,hidden:!0}))}function g(){"none"==l("#ead-download").val()?l("#ead-download-text").hide():l("#ead-download-text").show()}l("body").on("click",".awsm-embed",function(e){e.preventDefault(),n.show(),o.val(""),l(".ead-options").fadeIn(),l(".addurl-box").hide(),l(".upload-success").hide(),l("#embed-message").hide(),l("#insert-doc").attr("disabled","disabled"),l("#new-provider").show(),l("#ead-pseudo").hide(),l('select[name="ead-pseudo"]').val(""),l("#new-provider  option[value='microsoft']").attr("disabled",!1),l("#ead-downloadc").show(),g(),l("body").addClass("ead-popup-on"),tb_show("Embed Any Document","#TB_inline?inlineId=embed-popup-wrap&amp;width=1030&amp;modal=true",null),m(),l("#upload-doc").focus()}),l(".ead-usc").change(function(){v(l(this).attr("id")),g()}),l(".embedval").keyup(function(){v(l(this).attr("id"))}),l("#upload-doc").click(function(){if(d)return void d.open();(d=wp.media({title:"Embed Any Document",multiple:!1,library:{type:emebeder.validtypes},button:{text:emebeder.select_button}})).on("select",function(){F(d.state().get("selection").first().toJSON(),"upload")}),d.open()}),l("#ead-add-url").click(function(){var e=o.val();""!==e?function(e){{var d,o;l("#embed-message").hide(),function(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}(e)?(d=(d=(i=e).split("/").pop())||emebeder.from_url,o={url:i,filename:d},l("#insert-doc").removeAttr("disabled"),l("#ead-filename").html(emebeder.from_url),l("#ead-filesize").html("&nbsp;"),l(".upload-success").fadeIn(),n.hide(),b("link"),D(o,"link"),v()):h(emebeder.invalidurl)}}(e):(o.addClass("urlerror"),v())}),l("#insert-doc").click(function(){{var e;u?(e=!0,void 0!==wp.blocks&&void 0!==wp.blocks.getBlockType("embed-any-document/document")&&(e=!1),e&&wp.media.editor.insert(t.text()),w()):h(emebeder.nocontent)}}),l("#add-ead-document").on("click",function(e){e.preventDefault(),l(".addurl-box").fadeIn(),l(".ead-options").hide()}),l(".go-back").on("click",function(e){e.preventDefault(),l(".addurl-box").hide(),l(".ead-options").fadeIn()}),l("#embed-popup").on("click",".cancel-embed,.ead-close",function(e){e.preventDefault(),w()}),l(window).resize(function(){m()})});