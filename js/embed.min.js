jQuery(document).ready(function(m){var e=window.eadEmbed=window.eadEmbed||{};e.updateprovider=function(e,d){n(e,d)},e.human_filesize=function(e){!function(e){if(e<1024)return;var d=-1;for(;e/=1024,++d,1024<=e;);e.toFixed(1)}(e)};var d,o=m("#awsm-url"),b=m("#shortcode"),a=m("#embed-message p"),t=(m(".mceActionPanel"),m(".ead-container")),v="",i=emebeder.msextension;emebeder.drextension;function n(e,d){v=e.url,c(e,d),r(),function(e,d){m("#insert-doc").removeAttr("disabled"),m("#ead-filename").html(e.filename),e.filesizeHumanReadable?m("#ead-filesize").html(e.filesizeHumanReadable):m("#ead-filesize").html("&nbsp;");m(".upload-success").fadeIn(),t.hide(),l(d)}(e,d)}function h(e){return-1==e.indexOf("%")?(e=e.replace(/[^0-9]/g,""),e+="px"):(e=e.replace(/[^0-9]/g,""),e+="%"),e}function u(){var e=m("#TB_window"),d=m(window).width(),o=m(window).height(),a=1080<d?1080:d;e.size()&&(e.width(a-50).height(o-45),m("#TB_ajaxContent").css({width:"100%",height:"100%",padding:"0"}),e.css({"margin-left":"-"+parseInt((a-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:"20px","margin-top":"0"}),m("#TB_title").css({"background-color":"#fff",color:"#cfcfcf"}))}function w(e,d){var o=m("#ead-"+e).val();return o&&("ead-"+e==d||o!=emebeder[e])}function r(e){var d,o,a,t,n,i,u,r,l,F,c,s,p,f;e=void 0!==e&&e,v?b.text((d=v,o=e,a=h(m("#ead-height").val()),t=h(m("#ead-width").val()),n=m("#ead-download").val(),i=m("#ead-provider").val(),u=m("#ead-text").val(),r=m("#ead-cache").is(":checked"),f=p=s=c=F=l="",w("height",o)&&(l=' height="'+a+'"'),w("width",o)&&(F=' width="'+t+'"'),w("download",o)&&(c=' download="'+n+'"'),w("provider",o)&&(s=' viewer="'+i+'"'),w("text",o)&&"none"!=n&&(p=' text="'+u+'"'),"google"==i?(m("#eadcachemain").show(),r&&(f=' cache="off"')):m("#eadcachemain").hide(),"browser"===i?m(".ead-browser-viewer-note").show():m(".ead-browser-viewer-note").hide(),'[embeddoc url="'+d+'"'+F+l+c+s+f+p+"]")):b.text("")}function l(e){m(".uploaded-doccument").removeClass("ead-link ead-upload ead-dropbox ead-drive ead-box"),m(".uploaded-doccument").addClass("ead-"+e)}function F(){tb_remove(),setTimeout(function(){m("body").removeClass("ead-popup-on")},800)}function c(e,d){var o=["link","upload"].concat(["dropbox"]),a=i.split(","),t=e.filename;"link"==d&&(t=e.url);var n="."+t.split(".").pop();m.each(["built-in","browser","microsoft","dropbox"],function(e,d){m("#new-provider option[value='"+d+"']").attr({disabled:!1,hidden:!1})}),m(".ead-browser-viewer-note").hide(),-1!==m.inArray(d,o)&&(-1===m.inArray(n,a)?(m("#new-provider option[value='google']").attr("selected","selected"),m("#new-provider option[value='microsoft']").attr({disabled:!0,hidden:!0})):m("#new-provider option[value='microsoft']").attr("selected","selected"),"dropbox"!==d?m("#new-provider option[value='dropbox']").attr({disabled:!0,hidden:!0}):m("#new-provider option[value='dropbox']").attr("selected","selected"),".pdf"!=n&&m("#new-provider option[value='browser']").attr({disabled:!0,hidden:!0}),(".pdf"!=n||"link"===d&&-1===t.indexOf(emebeder.site_url))&&m("#new-provider option[value='built-in']").attr({disabled:!0,hidden:!0}))}function s(){"none"==m("#ead-download").val()?m("#ead-download-text").hide():m("#ead-download-text").show()}m("body").on("click",".awsm-embed",function(e){t.show(),o.val(""),m(".ead-options").fadeIn(),m(".addurl-box").hide(),m(".upload-success").hide(),m("#embed-message").hide(),m("#insert-doc").attr("disabled","disabled"),m("#new-provider").show(),m("#ead-pseudo").hide(),m("#new-provider  option[value='microsoft']").attr("disabled",!1),m("#ead-downloadc").show(),s(),e.preventDefault(),m("body").addClass("ead-popup-on"),tb_show("Embed Any Document","#TB_inline?inlineId=embed-popup-wrap&amp;width=1030&amp;modal=true",null),u(),m("#upload-doc").focus()}),m(".ead-usc").change(function(){r(m(this).attr("id")),s()}),m(".embedval").keyup(function(){r(m(this).attr("id"))}),m("#upload-doc").click(function(){if(d)return void d.open();(d=wp.media({title:"Embed Any Document",multiple:!1,library:{type:emebeder.validtypes},button:{text:emebeder.select_button}})).on("select",function(){n(d.state().get("selection").first().toJSON(),"upload")}),d.open()}),m("#ead-add-url").click(function(){var e=o.val();""!==e?function(e){{var d,o;m("#embed-message").hide(),function(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}(e)?(d=(d=(v=e).split("/").pop())||emebeder.from_url,o={url:v,filename:d},m("#insert-doc").removeAttr("disabled"),m("#ead-filename").html(emebeder.from_url),m("#ead-filesize").html("&nbsp;"),m(".upload-success").fadeIn(),t.hide(),l("link"),c(o,"link"),r()):function(e){m("#embed-message").fadeIn(),a.text(e)}(emebeder.invalidurl)}}(e):(o.addClass("urlerror"),r())}),m("#insert-doc").click(function(){{var e;v?(e=!0,void 0!==wp.blocks&&void 0!==wp.blocks.getBlockType("embed-any-document/document")&&(e=!1),e&&wp.media.editor.insert(b.text()),F()):showmsg(emebeder.nocontent)}}),m("#add-ead-document").on("click",function(e){e.preventDefault(),m(".addurl-box").fadeIn(),m(".ead-options").hide()}),m(".go-back").on("click",function(e){e.preventDefault(),m(".addurl-box").hide(),m(".ead-options").fadeIn()}),m("#embed-popup").on("click",".cancel-embed,.ead-close",function(e){e.preventDefault(),F()}),m(window).resize(function(){u()})});