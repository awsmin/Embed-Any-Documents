jQuery(document).ready(function(p){var t,d=p("#awsm-url"),m=p("#shortcode"),a=p("#embed-message p"),n=(p(".mceActionPanel"),p(".ead-container")),f="",i=emebeder.msextension;emebeder.drextension;function b(e){return-1==e.indexOf("%")?(e=e.replace(/[^0-9]/g,""),e+="px"):(e=e.replace(/[^0-9]/g,""),e+="%"),e}function o(){var e=p("#TB_window"),d=p(window).width(),o=p(window).height(),t=1080<d?1080:d;e.size()&&(e.width(t-50).height(o-45),p("#TB_ajaxContent").css({width:"100%",height:"100%",padding:"0"}),e.css({"margin-left":"-"+parseInt((t-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:"20px","margin-top":"0"}),p("#TB_title").css({"background-color":"#fff",color:"#cfcfcf"}))}function v(e,d){var o=p("#ead-"+e).val();return o&&("ead-"+e==d||o!=emebeder[e])}function u(e){var d,o,t,a,n,i,u,r,l,F,s,c;e=void 0!==e&&e,f?m.text((d=f,o=e,t=b(p("#ead-height").val()),a=b(p("#ead-width").val()),n=p("#ead-download").val(),i=p("#ead-provider").val(),u=p("#ead-text").val(),c=s=F=l=r="",v("height",o)&&(r=' height="'+t+'"'),v("width",o)&&(l=' width="'+a+'"'),v("download",o)&&(F=' download="'+n+'"'),v("provider",o)&&(s=' viewer="'+i+'"'),v("text",o)&&"none"!=n&&(c=' text="'+u+'"'),"browser"===i?p(".ead-browser-viewer-note").show():p(".ead-browser-viewer-note").hide(),'[embeddoc url="'+d+'"'+l+r+F+s+c+"]")):m.text("")}function r(e){p(".uploaded-doccument").removeClass("ead-link ead-upload ead-dropbox ead-drive ead-box"),p(".uploaded-doccument").addClass("ead-"+e)}function l(){tb_remove(),setTimeout(function(){p("body").removeClass("ead-popup-on")},800)}function F(e,d){var o=i.split(","),t=e.filename;"link"==d&&(t=e.url);var a="."+t.split(".").pop();p.each(["built-in","browser","microsoft"],function(e,d){p("#new-provider option[value='"+d+"']").attr({disabled:!1,hidden:!1})}),p(".ead-browser-viewer-note").hide(),-1!==p.inArray(d,["link","upload"])&&(-1===p.inArray(a,o)?(p("#new-provider option[value='google']").attr("selected","selected"),p("#new-provider option[value='microsoft']").attr({disabled:!0,hidden:!0})):p("#new-provider option[value='microsoft']").attr("selected","selected"),".pdf"!=a&&p("#new-provider option[value='browser']").attr({disabled:!0,hidden:!0}),(".pdf"!=a||"link"===d&&-1===t.indexOf(emebeder.site_url))&&p("#new-provider option[value='built-in']").attr({disabled:!0,hidden:!0}))}function s(){"none"==p("#ead-download").val()?p("#ead-download-text").hide():p("#ead-download-text").show()}p("body").on("click",".awsm-embed",function(e){n.show(),d.val(""),p(".ead-options").fadeIn(),p(".addurl-box").hide(),p(".upload-success").hide(),p("#embed-message").hide(),p("#insert-doc").attr("disabled","disabled"),p("#new-provider").show(),p("#ead-pseudo").hide(),p("#new-provider  option[value='microsoft']").attr("disabled",!1),p("#ead-downloadc").show(),s(),e.preventDefault(),p("body").addClass("ead-popup-on"),tb_show("Embed Any Document","#TB_inline?inlineId=embed-popup-wrap&amp;width=1030&amp;modal=true",null),o(),p("#upload-doc").focus()}),p(".ead-usc").change(function(){u(p(this).attr("id")),s()}),p(".embedval").keyup(function(){u(p(this).attr("id"))}),p("#upload-doc").click(function(){if(t)return void t.open();(t=wp.media({title:"Embed Any Document",multiple:!1,library:{type:emebeder.validtypes},button:{text:emebeder.select_button}})).on("select",function(){var e,d,o=t.state().get("selection").first().toJSON();d="upload",f=(e=o).url,F(e,d),u(),function(e,d){p("#insert-doc").removeAttr("disabled"),p("#ead-filename").html(e.filename),e.filesizeHumanReadable?p("#ead-filesize").html(e.filesizeHumanReadable):p("#ead-filesize").html("&nbsp;");p(".upload-success").fadeIn(),n.hide(),r(d)}(e,d)}),t.open()}),p("#ead-add-url").click(function(){var e=d.val();""!==e?function(e){{var d,o;p("#embed-message").hide(),function(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}(e)?(d=(d=(f=e).split("/").pop())||emebeder.from_url,o={url:f,filename:d},p("#insert-doc").removeAttr("disabled"),p("#ead-filename").html(emebeder.from_url),p("#ead-filesize").html("&nbsp;"),p(".upload-success").fadeIn(),n.hide(),r("link"),F(o,"link"),u()):function(e){p("#embed-message").fadeIn(),a.text(e)}(emebeder.invalidurl)}}(e):(d.addClass("urlerror"),updateshortcode())}),p("#insert-doc").click(function(){{var e;f?(e=!0,void 0!==wp.blocks&&void 0!==wp.blocks.getBlockType("embed-any-document/document")&&(e=!1),e&&wp.media.editor.insert(m.text()),l()):showmsg(emebeder.nocontent)}}),p("#add-ead-document").on("click",function(e){e.preventDefault(),p(".addurl-box").fadeIn(),p(".ead-options").hide()}),p(".go-back").on("click",function(e){e.preventDefault(),p(".addurl-box").hide(),p(".ead-options").fadeIn()}),p("#embed-popup").on("click",".cancel-embed,.ead-close",function(e){e.preventDefault(),l()}),p(window).resize(function(){o()})});