jQuery(function(l){var c=window.eadEmbed=window.eadEmbed||{};c.updateprovider=function(e,d){u(e,d)},c.human_filesize=function(e){!function(e){if(e<1024)return;var d=-1;for(;e/=1024,++d,1024<=e;);e.toFixed(1)}(e)},c.setpseudo=function(e){var d;d=e,l("#new-provider").hide(),l("#ead-pseudo").show(),l("#ead-downloadc").hide(),l('select[name="ead-pseudo"]').val(d)},c.ead_showmsg=function(e){r(e)};var e=wp.template("embed-popup-template");l("#embed-popup-wrap-template").html(e);var d,o=l("#embed-popup-wrap-template").html(),t="",a={},n=emebeder.msextension;function u(e,d){t=e.url,h(a=e,d),F(),function(e,d){l("#insert-doc").prop("disabled",!1),l("#ead-filename").html(e.filename),e.filesizeHumanReadable?l("#ead-filesize").html(e.filesizeHumanReadable):l("#ead-filesize").html("&nbsp;");l(".upload-success").fadeIn(),l(".ead-container").hide(),m(d)}(e,d)}function s(e){return-1==e.indexOf("%")?(e=e.replace(/[^0-9]/g,""),e+="px"):(e=e.replace(/[^0-9]/g,""),e+="%"),e}function i(){var e=l("#TB_window"),d=l(window).width(),o=l(window).height(),t=1080<d?1080:d;e.size()&&(e.width(t-50).height(o-45),l("#TB_ajaxContent").css({width:"100%",height:"100%",padding:"0"}),e.css({"margin-left":"-"+parseInt((t-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:"20px","margin-top":"0"}),l("#TB_title").css({"background-color":"#fff",color:"#cfcfcf"}))}function p(e,d){var o=l("#ead-"+e).val();return o&&("ead-"+e==d||o!=emebeder[e])}function r(e){l("#embed-message").fadeIn(),l("#embed-message p").text(e)}function F(e){e=void 0!==e&&e,a?l("#embed-popup #shortcode").text(function(e,d){var o=s(l("#ead-height").val()),t=s(l("#ead-width").val()),a=l("#ead-download").val(),n=l("#ead-provider").val(),u=l("#ead-text").val(),i=l("#ead-cache").is(":checked");c.shortcodeAttrs={},e.url&&(c.shortcodeAttrs.url=e.url),p("height",d)&&(c.shortcodeAttrs.height=o),p("width",d)&&(c.shortcodeAttrs.width=t),p("download",d)&&(c.shortcodeAttrs.download=a),p("provider",d)&&(c.shortcodeAttrs.viewer=n),p("text",d)&&"none"!=a&&(c.shortcodeAttrs.text=u),c.file=e,"google"==n?(l("#eadcachemain").show(),i&&(c.shortcodeAttrs.cache="off")):(l("#eadcachemain").hide(),l(".ead-browser-viewer-note").hide()),l("#embed-popup").trigger("ead_embed_shortcodetext",[c.shortcodeAttrs,c.file]);var r="";return l.each(c.shortcodeAttrs,function(e,d){r+=e+'="'+d+'" '}),"[embeddoc "+r.trim()+"]"}(a,e)):l("#embed-popup #shortcode").text("")}function m(e){l(".uploaded-doccument").removeClass("ead-link ead-upload ead-dropbox ead-drive ead-box"),l(".uploaded-doccument").addClass("ead-"+e)}function f(){tb_remove(),setTimeout(function(){l("body").removeClass("ead-popup-on")},800)}function h(e,d){var o=n.split(","),t=e.filename;"link"==d&&(t=e.url);var a="."+t.split(".").pop();l.each(["built-in","browser","microsoft"],function(e,d){l("#new-provider option[value='"+d+"']").attr({disabled:!1,hidden:!1})}),l(".ead-browser-viewer-note").hide(),-1!==l.inArray(d,["link","upload"])&&(-1===l.inArray(a,o)?(l("#new-provider option[value='google']").attr("selected","selected"),l("#new-provider option[value='microsoft']").attr({disabled:!0,hidden:!0}),l("#ead-provider").val(l("#new-provider option[value='google']").val())):(l("#new-provider option[value='microsoft']").attr("selected","selected"),l("#ead-provider").val(l("#new-provider option[value='microsoft']").val())),".pdf"!=a&&l("#new-provider option[value='browser']").attr({disabled:!0,hidden:!0}),(".pdf"!=a||"link"===d&&-1===t.indexOf(emebeder.site_url))&&l("#new-provider option[value='built-in']").attr({disabled:!0,hidden:!0}))}function v(){"none"==l("#ead-download").val()?l("#ead-download-text").hide():l("#ead-download-text").show()}l(document).on("click",".awsm-embed",function(e){0===l("#embed-popup").length&&l("body").append(o),e.preventDefault(),l(".ead-container").show(),l("#awsm-url").val(""),l(".ead-options").fadeIn(),l(".addurl-box").hide(),l(".upload-success").hide(),l("#embed-message").hide(),l("#insert-doc").prop("disabled",!0),l("#new-provider").show(),l("#ead-pseudo").hide(),l('select[name="ead-pseudo"]').val(""),l("#new-provider  option[value='microsoft']").attr("disabled",!1),l("#ead-downloadc").show(),v(),l("body").addClass("ead-popup-on"),tb_show("Embed Any Document","#TB_inline?inlineId=embed-popup-wrap&amp;width=1030&amp;modal=true",null),i(),l("#upload-doc").focus()}),l(document).on("change",".ead-usc",function(){F(l(this).attr("id")),v()}),l(".embedval").keyup(function(){F(l(this).attr("id"))}),l(document).on("click","#upload-doc",function(){if(d)return void d.open();(d=wp.media({title:"Embed Any Document",multiple:!1,library:{type:emebeder.validtypes},button:{text:emebeder.select_button}})).on("select",function(){u(d.state().get("selection").first().toJSON(),"upload")}),d.open()}),l(document).on("click","#ead-add-url",function(){var e=l("#awsm-url").val();""!==e?function(e){{var d;l("#embed-message").hide(),function(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}(e)?(d=(d=(t=e).split("/").pop())||emebeder.from_url,a={url:t,filename:d},l("#insert-doc").prop("disabled",!1),l("#ead-filename").html(emebeder.from_url),l("#ead-filesize").html("&nbsp;"),l(".upload-success").fadeIn(),l(".ead-container").hide(),m("link"),h(a,"link"),F()):r(emebeder.invalidurl)}}(e):(l("#awsm-url").addClass("urlerror"),F())}),l(document).on("click","#insert-doc",function(){{var e;a?(e=!0,void 0!==wp.blocks&&void 0!==wp.blocks.getBlockType("embed-any-document/document")&&(e=!1),e&&wp.media.editor.insert(l("#embed-popup #shortcode").text()),f()):r(emebeder.nocontent)}}),l(document).on("click","#add-ead-document",function(e){e.preventDefault(),l(".addurl-box").fadeIn(),l(".ead-options").hide()}),l(document).on("click",".go-back",function(e){e.preventDefault(),l(".addurl-box").hide(),l(".ead-options").fadeIn()}),l(document).on("click","#embed-popup .cancel-embed,.ead-close",function(e){e.preventDefault(),f()}),l(window).resize(function(){i()})});