jQuery(document).ready(function(m){var v=window.eadEmbed=window.eadEmbed||{};v.updateprovider=function(e,d){o(e,d)},v.human_filesize=function(e){!function(e){if(e<1024)return;var d=-1;for(;e/=1024,++d,1024<=e;);e.toFixed(1)}(e)},v.newprovider="";var e,d=m("#awsm-url"),w=m("#shortcode"),i=m("#embed-message p"),a=(m(".mceActionPanel"),m(".ead-container")),b="",t=emebeder.msextension;emebeder.drextension,m("#embed-popup");function o(e,d){b=e.url,F(e,d),u(),function(e,d){m("#insert-doc").removeAttr("disabled"),m("#ead-filename").html(e.filename),e.filesizeHumanReadable?m("#ead-filesize").html(e.filesizeHumanReadable):m("#ead-filesize").html("&nbsp;");m(".upload-success").fadeIn(),a.hide(),r(d)}(e,d)}function h(e){return-1==e.indexOf("%")?(e=e.replace(/[^0-9]/g,""),e+="px"):(e=e.replace(/[^0-9]/g,""),e+="%"),e}function n(){var e=m("#TB_window"),d=m(window).width(),o=m(window).height(),i=1080<d?1080:d;e.size()&&(e.width(i-50).height(o-45),m("#TB_ajaxContent").css({width:"100%",height:"100%",padding:"0"}),e.css({"margin-left":"-"+parseInt((i-50)/2,10)+"px"}),void 0!==document.body.style.maxWidth&&e.css({top:"20px","margin-top":"0"}),m("#TB_title").css({"background-color":"#fff",color:"#cfcfcf"}))}function D(e,d){var o=m("#ead-"+e).val();return o&&("ead-"+e==d||o!=emebeder[e])}function u(e){var d,o,i,a,t,n,u,r,l,F,c,s,p,f;e=void 0!==e&&e,b?w.text((d=b,o=e,i=h(m("#ead-height").val()),a=h(m("#ead-width").val()),t=m("#ead-download").val(),n=m("#ead-provider").val(),u=m("#ead-text").val(),r=m("#ead-cache").is(":checked"),f=p=s=c=F=l="",D("height",o)&&(l=' height="'+i+'"'),D("width",o)&&(F=' width="'+a+'"'),D("download",o)&&(c=' download="'+t+'"'),D("provider",o)&&(s=' viewer="'+n+'"'),m("#embed-popup [data-setting]").each(function(){"viewer"==m(this).data("setting")&&(s=' viewer="'+n+'"',""!=v.newprovider&&(s=' viewer="'+v.newprovider+'"')),v.newprovider=""}),D("text",o)&&"none"!=t&&(p=' text="'+u+'"'),"google"==n?(m("#eadcachemain").show(),r&&(f=' cache="off"')):m("#eadcachemain").hide(),"browser"===n?m(".ead-browser-viewer-note").show():m(".ead-browser-viewer-note").hide(),'[embeddoc url="'+d+'"'+F+l+c+s+f+p+"]")):w.text("")}function r(e){m(".uploaded-doccument").removeClass("ead-link ead-upload ead-dropbox ead-drive ead-box"),m(".uploaded-doccument").addClass("ead-"+e)}function l(){tb_remove(),setTimeout(function(){m("body").removeClass("ead-popup-on")},800)}function F(e,d){var o=t.split(","),i=e.filename;"link"==d&&(i=e.url);var a="."+i.split(".").pop();m.each(["built-in","browser","microsoft"],function(e,d){m("#new-provider option[value='"+d+"']").attr({disabled:!1,hidden:!1})}),m(".ead-browser-viewer-note").hide(),-1!==m.inArray(d,["link","upload"])&&(m("#new-provider option:selected").removeAttr("selected"),-1===m.inArray(a,o)?(m("#new-provider option[value='google']").attr("selected","selected"),m("#new-provider option[value='microsoft']").attr({disabled:!0,hidden:!0}),m("#ead-provider").val(m("#new-provider option[value='google']").val())):(m("#new-provider option[value='microsoft']").attr("selected","selected"),m("#ead-provider").val(m("#new-provider option[value='microsoft']").val())),".pdf"!=a&&m("#new-provider option[value='browser']").attr({disabled:!0,hidden:!0}),(".pdf"!=a||"link"===d&&-1===i.indexOf(emebeder.site_url))&&m("#new-provider option[value='built-in']").attr({disabled:!0,hidden:!0}))}function c(){"none"==m("#ead-download").val()?m("#ead-download-text").hide():m("#ead-download-text").show()}m("body").on("click",".awsm-embed",function(e){a.show(),d.val(""),m(".ead-options").fadeIn(),m(".addurl-box").hide(),m(".upload-success").hide(),m("#embed-message").hide(),m("#insert-doc").attr("disabled","disabled"),m("#new-provider").show(),m("#ead-pseudo").hide(),m("#new-provider  option[value='microsoft']").attr("disabled",!1),m("#ead-downloadc").show(),c(),e.preventDefault(),m("body").addClass("ead-popup-on"),tb_show("Embed Any Document","#TB_inline?inlineId=embed-popup-wrap&amp;width=1030&amp;modal=true",null),n(),m("#upload-doc").focus()}),m(".ead-usc").change(function(){u(m(this).attr("id")),c()}),m(".embedval").keyup(function(){u(m(this).attr("id"))}),m("#upload-doc").click(function(){if(e)return void e.open();(e=wp.media({title:"Embed Any Document",multiple:!1,library:{type:emebeder.validtypes},button:{text:emebeder.select_button}})).on("select",function(){o(e.state().get("selection").first().toJSON(),"upload")}),e.open()}),m("#ead-add-url").click(function(){var e=d.val();""!==e?function(e){{var d,o;m("#embed-message").hide(),function(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)}(e)?(d=(d=(b=e).split("/").pop())||emebeder.from_url,o={url:b,filename:d},m("#insert-doc").removeAttr("disabled"),m("#ead-filename").html(emebeder.from_url),m("#ead-filesize").html("&nbsp;"),m(".upload-success").fadeIn(),a.hide(),r("link"),F(o,"link"),u()):function(e){m("#embed-message").fadeIn(),i.text(e)}(emebeder.invalidurl)}}(e):(d.addClass("urlerror"),u())}),m("#insert-doc").click(function(){{var e;b?(e=!0,void 0!==wp.blocks&&void 0!==wp.blocks.getBlockType("embed-any-document/document")&&(e=!1),e&&wp.media.editor.insert(w.text()),l()):showmsg(emebeder.nocontent)}}),m("#add-ead-document").on("click",function(e){e.preventDefault(),m(".addurl-box").fadeIn(),m(".ead-options").hide()}),m(".go-back").on("click",function(e){e.preventDefault(),m(".addurl-box").hide(),m(".ead-options").fadeIn()}),m("#embed-popup").on("click",".cancel-embed,.ead-close",function(e){e.preventDefault(),l()}),m(window).resize(function(){n()})});